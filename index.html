<!DOCTYPE html>
<html>
  <head>
    <title>
      Payment Method Identifiers
    </title>
    <meta charset='utf-8'>
    <script src='https://www.w3.org/Tools/respec/respec-w3c' async class=
    'remove'></script>
    <script class='remove'>
    var respecConfig = {
      formerEditors: [
        {
          name: "Adrian Bateman",
          company: "Microsoft Corporation",
          w3cid: 42763,
        },
        {
          name: "Domenic Denicola",
          company: "Google",
          w3cid: 52873,
        },
        {
          name: "Zach Koch",
          company: "Google",
          w3cid: 76588,
        },
        {
          name: "Roy McElmurry",
          company: "Facebook",
          w3cid: 88345,
        },
      ],
      editors: [
        {
          name: "Marcos Cáceres",
          company: "W3C",
          w3cid: 39125,
        },
      ],
      crEnd: "2017-10-31",
      github: "w3c/payment-method-id",
      implementationReportURI: "https://w3c.github.io/test-results/payment-method-id/all.html",
      license: "w3c-software-doc",
      previousMaturity: "FPWD",
      previousPublishDate: "2016-04-21",
      specStatus: "ED",
      // We can only indirectly test conformance, so we rely on certain tests
      // in the Payment Request API.
      testSuiteURI: "https://wpt.live/payment-method-id/",
      group: "payments",
      xref: ["URL", "HTML", "FETCH", "PAYMENT-REQUEST"]
    };
    </script>
  </head>
  <body>
    <section id='abstract'>
      <p>
        This specification defines payment method identifiers and how they are
        validated, and, where applicable, minted and formally registered with
        the <a href="https://www.w3.org/">W3C</a>. Other specifications (e.g.,
        the [[[payment-request]]]) make use of these identifiers to facilitate
        monetary transactions on the web platform.
      </p>
    </section>
    <section id='sotd'>
      <p>
        The working group demonstrates implementation experience by producing
        an <a href=
        "https://w3c.github.io/test-results/payment-method-id/all.html">implementation
        report</a>. The report shows two or more independent implementations
        passing each mandatory test in the <a href=
        "https://w3c-test.org/payment-method-id/">test suite</a> (i.e., each
        test corresponds to a MUST requirement of the specification).
      </p>
      <p>
        There has been no change in dependencies on other workings groups
        during the development of this specification.
      </p>
    </section>
    <section>
      <h2>
        Payment method identifiers (PMIs)
      </h2>
      <p>
        A <dfn data-abbr="PMI" data-export="">payment method identifier</dfn>
        is a [=URLs=] that identifies a [=payment handler=].
      </p>
      <section>
        <h3>
          Validity
        </h3>
        <p>
          Specifications that rely on <a>payment method identifiers</a> MUST
          specify their own rules for handling invalid payment method
          identifiers.
        </p>
        <p>
          The steps to <dfn data-export="">validate a payment method
          identifier</dfn> with a string |pmi:string| are given by the
          following algorithm. It returns true if the |pmi| is valid.
        </p>
        <ol class="algorithm">
          <li>Let |url:URL| be the result of running the <a>basic URL
          parser</a> with |pmi|.
          </li>
          <li>
            <a>Validate a URL-based payment method identifier</a> passing |url|
            and return the result.
          </li>
        </ol>
      </section>
    </section>
    <section>
      <h2>
        URL-based payment method identifiers
      </h2>
      <p>
        A <dfn data-export="">URL-based payment method identifier</dfn> is a
        <a>URL</a> that is valid as per the steps to <a>validate a URL-based
        payment method identifier</a>.
      </p>
      <div class="note">
        <p>
          Developers wanting to use a URL-based payment method identifier for a
          third party payment handler are encouraged to read the <a href=
          "https://github.com/w3c/payment-request-info/wiki/PaymentMethodPractice">
          Payment Method Best Practice</a> document.
        </p>
      </div>
      <section>
        <h2>
          Validation
        </h2>
        <p>
          The steps to <dfn data-export="">validate a URL-based payment method
          identifier</dfn> are given by the following algorithm. The algorithm
          takes a <a>URL</a> |url:URL| as input and returns true if the URL is
          valid:
        </p>
        <ol class="algorithm" data-cite="URL">
          <li>If |url|'s [=url/scheme=] is not "https", return false.
          </li>
          <li>If |url|'s [=url/username=] or [=url/password=] is not the empty
          string, return false.
          </li>
          <li>Otherwise, return true.
          </li>
        </ol>
        <pre class="example js" title="valid and invalid URL-based PMIs">
          const valid = [
            {
              supportedMethods: "https://example.com/pay",
            },
            {
              supportedMethods: "https://example.com/pay?version=1",
            },
            {
              supportedMethods: "https://example.com/pay/version/1",
            },
          ];

          const invalid = [
            {
              // ❌ Uses http://, a username, and a password.
              supportedMethods: "http://username:password@example.com/pay",
            },
            {
              // ❌ Uses unknown URI scheme.
              supportedMethods: "unknown://example.com/pay",
            },
          ];
        </pre>
      </section>
      <section>
        <h2>
          Comparison
        </h2>
        <p data-tests="payment-request-ctor-pmi-handling.https.html">
          User agents MUST perform comparisons of <a>URL-based payment method
          identifiers</a> using [[URL]]'s [=URL/equal=].
        </p>
      </section>
      <section>
        <h2>
          Fetching (dereferencing)
        </h2>
        <p>
          It is OPTIONAL for user agents to [=fetch=] a <a>URL-based payment
          method identifier</a>.
        </p>
      </section>
    </section>
    <section class="informative">
      <h2>
        URL-based PMI and third-party payment handlers
      </h2>
      <p>
        Developers wanting to use a URL-based payment method identifier for a
        third party payment handler are encouraged to read the
        [[[payment-method-manifest]]] specification and the <a href=
        "https://github.com/w3c/payment-request-info/wiki/PaymentMethodPractice">
        Payment Method Best Practice</a> wiki page. Together, these documents
        describe how to manage the ecosystem of authorized payment handlers for
        a payment method, including just-in-time payment handler installation
        by the browser.
      </p>
    </section>
    <section>
      <h2>
        Privacy and security consideration
      </h2>
      <p>
        There are no known privacy or security concerns to be taken into
        considerations at this time.
      </p>
    </section>
    <section id="conformance"></section>
  </body>
</html>
